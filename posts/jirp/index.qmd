---
title: "Juneau Icefield Research Program"
description: "2021 Juneau Icefield Research Program"
author: "Liam Kirkpatrick"
date: "2021-08-15"
categories: [fieldwork]
#image: "/files/images/placeholder2.JPG"
image: "/files/images/jirp/placeholder.jpeg"
#css: /custom.css
#draft: true
---

<div class="q-gallery" data-gallery="/files/images/jirp/jirp.yml"></div>

<script>
(async () => {

  // Find all gallery placeholders on the page
  const nodes = document.querySelectorAll(".q-gallery[data-gallery]");
  for (const node of nodes) {
    const ymlPath = node.getAttribute("data-gallery");

    // Load YAML and parse it (Quarto sites already ship Bootstrap, but not YAML parsing)
    // We'll load a tiny YAML parser from a CDN.
    const ensureYaml = () =>
      new Promise((resolve, reject) => {
        if (window.jsyaml) return resolve();
        const s = document.createElement("script");
        s.src = "https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js";
        s.onload = resolve;
        s.onerror = reject;
        document.head.appendChild(s);
      });

    await ensureYaml();

    const ymlText = await fetch(ymlPath).then(r => {
      if (!r.ok) throw new Error(`Could not load gallery YAML: ${ymlPath}`);
      return r.text();
    });

    const gallery = window.jsyaml.load(ymlText);
    const id = gallery.id || `gallery-${Math.random().toString(16).slice(2)}`;
    const showCaptions = (gallery.show_captions || "below").toLowerCase();
    const images = gallery.images || [];

    if (!images.length) {
      node.innerHTML = "<p><em>No images found for this gallery.</em></p>";
      continue;
    }

    // Build carousel HTML (Bootstrap 5)
    const indicators = images.map((_, i) => `
      <button type="button" data-bs-target="#${id}" data-bs-slide-to="${i}"
        class="${i === 0 ? "active" : ""}"
        aria-current="${i === 0 ? "true" : "false"}"
        aria-label="Slide ${i + 1}">
      </button>
    `).join("");

    const slides = images.map((img, i) => {
      const title = img.title ? `<div class="qcap-title">${escapeHtml(img.title)}</div>` : "";
      const caption = img.caption ? `<div class="qcap-caption">${escapeHtml(img.caption)}</div>` : "";
      const alt = img.alt ? escapeHtml(img.alt) : "";

      const overlay = (showCaptions === "overlay")
        ? `<div class="carousel-caption qcap-overlay">${title}${caption}</div>`
        : "";

      const below = (showCaptions === "below")
        ? `<div class="qcap-below">${caption}</div>`
        : "";

      return `
        <div class="carousel-item ${i === 0 ? "active" : ""}">
          <img src="${img.src}" class="d-block w-100 q-gallery-img" alt="${alt}">
          ${overlay}
          ${below}
        </div>
      `;
    }).join("");

    node.innerHTML = `
      <div id="${id}" class="carousel slide" tdata-bs-ride="false">
        <div class="carousel-indicators">${indicators}</div>
        <div class="carousel-inner">${slides}</div>
        <button class="carousel-control-prev" type="button" data-bs-target="#${id}" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#${id}" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    `;

    // Small helper to avoid HTML injection from captions
    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }
  }
})();
</script>

<!--Include social share buttons-->

{{< include /files/includes/_socialshare.qmd >}}
